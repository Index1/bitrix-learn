<?php    define('NEED_AUTH', true);    use Bitrix\Main,        Bitrix\Main\Context;    class CEuclihellJobComponentResponse extends CBitrixComponent    {        public function checkModules()        {            if(!CModule::IncludeModule('iblock'))                throw new Main\LoaderException('Модуль iblock не был загружён!');        }        public function onPrepareComponentParams($params)        {            $resulte = [                'JobID' => Context::getCurrent()->getRequest()->getPost('JobID'),                'IBLOCK_ID' => $params['IBLOCK_ID'],                'IBLOCK_SECTION_ID ' => $params['IBLOCK_SECTION_ID'],            ];            return $resulte;        }        public function getFunction()        {            $request = Context::getCurrent()->getRequest();            if(getListAdd($this->arParams, $request->getPost('JobID')))            {                if($request->getPost('DescMail'))                {                    if(!empty($request->getPost('DescMail')) && !is_int($request->getPost('JobID')))                    {                        $el = new CIBlockElement;                        $fields = [                            'CREATED_BY' => $GLOBALS['USER']->GetID(),                            'IBLOCK_SECTION_ID' => $this->arParams['IBLOCK_SECTION_ID'],                            'IBLOCK_ID' => $this->arParams['IBLOCK_ID'],                            'PROPERTY_VALUES' => [                                'email' => $GLOBALS['USER']->GetEmail(),                                'JobID' => $request->getPost('JobID'),                                'DescMail' => $request->getPost('DescMail')                            ],                            'NAME' => 'Отклик на вакансию',                            'ACTIVE' => 'Y'                        ];                        $send = $el->Add($fields);                        if($send)                            ShowMessage('Вы успешно откликнулись за вакансию!');                        else                            ShowMessage('Что-то пошло не так!');                    }                } else {                    return $this->includeComponentTemplate();                }            }            else {                ShowMessage('Вы уже подавали откликались на вакансию!');            }        }        public function executeComponent()        {            global $APPLICATION;            try {                $this->checkModules();                if(Context::getCurrent()->getRequest()->getPost('JobID'))                    $APPLICATION->RestartBuffer();                $this->getFunction();                if(Context::getCurrent()->getRequest()->getPost('JobID'))                    die();            } catch (Exception $e) {                ShowMessage($e);            }        }    }?>